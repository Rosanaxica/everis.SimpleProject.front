<!-- {{dadosPrincipaisForm.value | json}} -->

<form [formGroup]="dadosPrincipaisForm">
  <fieldset class="border mb-4">
    <legend class="col-form-label">Projeto</legend>

    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Status do Projeto *</label>
        <select formControlName="statusProjetoId" *ngIf="projeto.id > 0; else novoProjeto" class="form-control" id="statusProjetoId" name="statusProjetoId">
          <option *ngFor="let status of status"  value="{{status.id}}">{{status.descricao}}</option>
        </select>
        <ng-template #novoProjeto>
          <select formControlName="statusProjetoId" class="form-control" id="statusProjetoId" name="statusProjetoId">
            <option value="7" selected >Proposta</option>
          </select>
        </ng-template>
      </div>
      <!-- <div class="alert alert-danger mt-2" *ngIf="!validStatus">
        <i class="fa fa-times mr-2"></i>
        <small>Por favor, informe o status do Projeto.</small>
      </div> -->
    </div>

    <div class="form-group mt-4 row">

      <div class="col-md-3">
        <input type="text" formControlName="codProjeto" class="form-control" id="codProjeto" name="codProjeto"
          placeholder="Codigo do Projeto *" maxlength="10" />
        <div class="alert alert-danger mt-2" *ngIf="dadosPrincipaisForm.controls.codProjeto.touched && dadosPrincipaisForm.controls.codProjeto.hasError('required')">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Código do Projeto.</small>
        </div>
      </div>
      <div class="col-md-8">
        <input type="text" formControlName="nomeProjeto" class="form-control" id="nomeProjeto" name="nomeProjeto"
          placeholder="Nome do Projeto *" maxlength="200" />
      </div>

    </div>

    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Status da Proposta *</label>
        <select formControlName="statusProposta" class="form-control" id="statusProposta" name="statusProposta">
          <option value="aceitaPrimeiroEnvio">Aceita Primeiro Envio</option>
          <option value="aceitaSegundoEnvio">Aceita Segundo Envio</option>
          <option value="cancelado">Cancelado</option>
          <option value="concluido">Concluido</option>
          <option value="demandaPerdida">Demanda Perdida</option>
        </select>
      </div>
      <div class="col-md-3">
        <label>Duração *</label>
        <input type="number" formControlName="duracao" class="form-control" id="duracao" name="duracao" min="1" max="99999" 
          (keydown)="setMaxValue('duracao')"/>
        <div *ngIf="dadosPrincipaisForm.controls.duracao.touched && dadosPrincipaisForm.controls.duracao.errors">
          <small *ngIf="dadosPrincipaisForm.controls.duracao.errors.required">*Informar a duração</small>
        </div>
      </div>

      <div class="col-md-3">
        <label>Tarifa *</label>
        <input type="number" formControlName="tarifa" class="form-control" id="tarifa" name="tarifa" min="1" max="999999999" 
        (keydown)="setMaxValue('tarifa')" />
        <div *ngIf="dadosPrincipaisForm.controls.tarifa.touched && dadosPrincipaisForm.controls.tarifa.errors">
          <small *ngIf="dadosPrincipaisForm.controls.tarifa.errors.required">*Informar valor</small>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <div class="col-md-3">
        <label for="data">Data Recebida *</label>
        <input type="date" formControlName="dataRecebida" class="form-control" id="dataRecebida" name="dataRecebida" (change)="validaDataRecebida()"/>
      </div>
      <div class="col-md-3">
        <label for="data">Data Início</label>
        <input type="date" formControlName="dataInicio" class="form-control" id="dataInicio" name="dataInicio"/>
      </div>
      <div class="col-md-3">
        <label for="data">Data Entrega Proposta</label>
        <input type="date" formControlName="dataProposta"  (blur)="obterDadosForm()" class="form-control" id="dataProposta" name="dataProposta"/>
      </div>
      <div class="col-md-3">
          <label for="data">Data Final</label>
          <input type="date" formControlName="dataFinal" class="form-control" id="dataFinal" name="dataFinal" (change)="validaDataFinal()"/>
      </div>
    </div>
  </fieldset>

  <fieldset class="border mb-4">
    <legend class="col-form-label">Dados Internos</legend>
    <div class="form-group row">
      <div class="col-md-4">
        <label for="label">Tecnologia *</label>
        <select formControlName="tecnologiaId" class="form-control" id="tecnologiaid" name="tecnologiaid">
          <option *ngFor="let tecnologia of tecnologia" value="{{tecnologia.id}}">{{tecnologia.nome}}</option>
        </select>
      </div>

      <div class="col-md-3">
        <label for="label">EXT *</label>

        <select formControlName="ext" class="form-control" id="ext" name="ext">
            <option value="EXT-011198-00079">EXT-011198-00079</option>
            <option value="EXT-011198-00083">EXT-011198-00083</option>
            <option value="EXT-011198-00100">EXT-011198-00100</option>
            <option value="EXT-011198-00101">EXT-011198-00101</option>
            <option value="EXT-011198-00104">EXT-011198-00104</option>
            <option value="EXT-011198-00105">EXT-011198-00105</option>
            <option value="EXT-011198-00107">EXT-011198-00107</option>
            <option value="EXT-011198-00108">EXT-011198-00108</option>
            <option value="EXT-011198-00110">EXT-011198-00110</option>
            <option value="EXT-011198-00112">EXT-011198-00112</option>
            <option value="EXT-011198-00113">EXT-011198-00113</option>
            <option value="EXT-011198-00114">EXT-011198-00114</option>
            <option value="EXT-011198-00117">EXT-011198-00117</option>
            <option value="EXT-011198-00118">EXT-011198-00118</option>
            <option value="EXT-011198-00119">EXT-011198-00119</option>
            <option value="EXT-011198-00120">EXT-011198-00120</option>
            <option value="EXT-011198-00121">EXT-011198-00121</option>
            <option value="EXT-011198-00122">EXT-011198-00122</option>
            <option value="EXT-011198-00123">EXT-011198-00123</option>
            <option value="EXT-011198-00124">EXT-011198-00124</option>
        </select>
      </div>

      <div class="col-md-2">
        <label for="label">Tamanho *</label>

        <select formControlName="tamanho" class="form-control" id="tamanho" name="tamanho">
          <option value="P">P</option>
          <option value="M">M</option>
          <option value="G">G</option>
        </select>
      </div>

      <div class="col-md-3">
        <label for="label">Tipo de Demanda *</label>

        <select formControlName="tipoDemanda" class="form-control" id="tipoDemanda" name="tipoDemanda">
          <option value="Commodities">Commodities</option>
          <option value="Especialista">Especialista</option>
        </select>
      </div>
    </div>
  </fieldset>


  <fieldset class="border mb-4">
    <legend class="col-form-label">Dados do Cliente</legend>
    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Empresa *</label>
        <select formControlName="empresaId" class="form-control" id="empresaId" name="empresaId">
          <option *ngFor="let empresa of empresas" value="{{empresa.id}}">{{empresa.nome}}</option>
        </select>
      </div>

      <div class="col-md-2">
        <label for="label">Sigla *</label>

        <select formControlName="siglaId" class="form-control" id="siglaid" name="siglaId">
          <option *ngFor="let sigla of sigla" value="{{sigla.id}}">{{sigla.descricao}}</option>

        </select>
      </div>

      <div class="col-md-2">
        <label for="label">Diretoria *</label>

        <select formControlName="diretoriaId" class="form-control" id="diretoriaId" name="diretoriaid">
          <option *ngFor="let dir of diretoria" value="{{dir.id}}">{{dir.descricao}}</option>

        </select>
      </div>

      <div class="col-md-3">
        <label for="label">Superintendência *</label>

        <select formControlName="superintendenciaId" class="form-control" id="superintendenciaId" name="superintendenciaid">
          <option *ngFor="let superintendencia of superintendencia" value="{{superintendencia.id}}">{{superintendencia.descricao}}</option>

        </select>
      </div>
    </div>
  </fieldset>

  <fieldset class="border mb-3">
    <legend class="col-form-label">Esforço</legend>
    <div class="form-group row">
      <div class="col-md-3">
        <label>Serviço 1</label>
        <input type="number" formControlName="qtdHorasServico1" class="form-control" id="qtdhorasservico1" name="qtdhorasservico1"
        min="1" max="9999999999" 
         (keydown)="setMaxValue('qtdHorasServico1')" />
          <div *ngIf="dadosPrincipaisForm.controls.qtdHorasServico1.touched && dadosPrincipaisForm.controls.qtdHorasServico1.errors">
           <small *ngIf="dadosPrincipaisForm.controls.qtdHorasServico1.errors.required">*Informar quantidade de horas</small>
          </div>
      </div>

      <div class="col-md-3">
        <label>Serviço 2</label>
        <input type="number" formControlName="qtdHorasServico2" class="form-control" id="qtdhorasservico2" name="qtdhorasservico2"
        min="1" max="9999999999" 
         (keydown)="setMaxValue('qtdHorasServico2')" />
          <div *ngIf="dadosPrincipaisForm.controls.qtdHorasServico2.touched && dadosPrincipaisForm.controls.qtdHorasServico2.errors">
           <small *ngIf="dadosPrincipaisForm.controls.qtdHorasServico2.errors.required">*Informar quantidade de horas</small>
          </div>
      </div>



      <div class="col-md-3">
        <label>Serviço 3</label>
        <input type="number" formControlName="qtdHorasServico3" class="form-control" id="qtdhorasservico3" name="qtdhorasservico3"
        min="1" max="9999999999" 
         (keydown)="setMaxValue('qtdHorasServico3')" />
          <div *ngIf="dadosPrincipaisForm.controls.qtdHorasServico3.touched && dadosPrincipaisForm.controls.qtdHorasServico3.errors">
           <small *ngIf="dadosPrincipaisForm.controls.qtdHorasServico3.errors.required">*Informar quantidade de horas</small>
          </div>
      </div>
    </div>
  </fieldset>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Escopo do Projeto
      </mat-panel-title>
    </mat-expansion-panel-header>
    <div class="form-group ">
      <textarea formControlName="escopoProjeto" class="form-control" id="escopoprojeto" name="escopoprojeto" rows="5"
        maxlength="500"></textarea>
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Fora do Escopo do Projeto
      </mat-panel-title>
    </mat-expansion-panel-header>
    <textarea formControlName="foraEscopoProjeto" class="form-control" id="foraescopoprojeto" name="foraescopoprojeto"
      maxlength="500" rows="5"></textarea>
  </mat-expansion-panel>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Premissas
      </mat-panel-title>
    </mat-expansion-panel-header>

    <textarea formControlName="premissas" class="form-control" id="premissas" name="premissas" rows="5" maxlength="500"></textarea>

  </mat-expansion-panel>

  <div class="row align-items-center mt-2 mb-4">
    <div class="col d-flex justify-content-end">
      <button type="button" class="btn everis mr-2" (click)="Adicionar()" [disabled]="!formEstaValido()">Salvar</button>
      <button type="button" class="btn cancelar" (click)="cancelar()">Cancelar</button>
    </div>
  </div>

</form>