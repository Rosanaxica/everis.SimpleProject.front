<form [formGroup]="dadosPrincipaisForm">
  <fieldset class="border mb-4">
    <legend class="col-form-label">Projeto</legend>

    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Status do Projeto *</label>
        <select formControlName="statusProjetoId" class="form-control" id="statusProjetoId" name="statusProjetoId">
          <option *ngFor="let status of status" value="{{status.id}}">{{status.descricao}}</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.statusProjetoId.touched || dadosPrincipaisForm.controls.statusProjetoId.dirty) && dadosPrincipaisForm.controls.statusProjetoId.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Status do Projeto.</small>
        </div>
      </div>
    </div>

    <div class="form-group mt-4 row">
      <div class="col-md-3">
        <input type="text" formControlName="codProjeto" class="form-control" id="codProjeto" name="codProjeto"
          placeholder="Codigo do Projeto *" maxlength="10" />
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.codProjeto.touched || dadosPrincipaisForm.controls.codProjeto.dirty) && dadosPrincipaisForm.controls.codProjeto.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Status da Proposta.</small>
        </div>
      </div>
      <div class="col-md-8">
        <input type="text" formControlName="nomeProjeto" class="form-control" id="nomeProjeto" name="nomeProjeto"
          placeholder="Nome do Projeto *" maxlength="200" />
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.nomeProjeto.touched || dadosPrincipaisForm.controls.nomeProjeto.dirty) && dadosPrincipaisForm.controls.nomeProjeto.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Nome do Projeto.</small>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Status da Proposta *</label>
        <select formControlName="statusProposta" class="form-control" id="statusProposta" name="statusProposta">
          <option value="aceitaPrimeiroEnvio">Aceita Primeiro Envio</option>
          <option value="aceitaSegundoEnvio">Aceita Segundo Envio</option>
          <option value="cancelado">Cancelado</option>
          <option value="concluido">Concluido</option>
          <option value="demandaPerdida">Demanda Perdida</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.statusProposta.touched || dadosPrincipaisForm.controls.statusProposta.dirty) && dadosPrincipaisForm.controls.statusProposta.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Status da Proposta</small>
        </div>
      </div>
      <div class="col-md-3">
        <label>Duração *</label>
        <input type="number" formControlName="duracao" class="form-control" id="duracao" name="duracao" min="1" max="99999"
          (keydown)="setMaxValue('duracao')" />
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.duracao.touched || dadosPrincipaisForm.controls.duracao.dirty) && dadosPrincipaisForm.controls.duracao.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Duração do Projeto</small>
        </div>
      </div>
      <div class="col-md-3">
        <label>Tarifa *</label>
        <input type="number" formControlName="tarifa" class="form-control" id="tarifa" name="tarifa" min="1" max="999999999"
          (keydown)="setMaxValue('tarifa')" />
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.tarifa.touched || dadosPrincipaisForm.controls.tarifa.dirty) && dadosPrincipaisForm.controls.tarifa.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Tarifa a ser cobrada</small>
        </div>
      </div>
    </div>
    <div class="form-group row">
      <div class="col-md-3">
        <label for="data">Data de Recebimento da Proposta *</label>
        <input type="date" formControlName="dataRecebida" class="form-control" id="dataRecebida" name="dataRecebida"
          (change)="validaDataRecebida()" />
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.dataRecebida.touched || dadosPrincipaisForm.controls.dataRecebida.dirty) && dadosPrincipaisForm.controls.dataRecebida.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Data de Recebimento</small>
        </div>
      </div>
      <div class="col-md-3">
        <label for="data">Data de Envio da Proposta</label>
        <input type="date" formControlName="dataProposta" (blur)="obterDadosForm()" class="form-control" id="dataProposta"
          name="dataProposta" />
      </div>
      <div class="col-md-3">
        <label for="data">Data de Início do Projeto</label>
        <input type="date" formControlName="dataInicio" class="form-control" id="dataInicio" name="dataInicio" />
      </div>
      <div class="col-md-3">
        <label for="data">Data Final do Projeto</label>
        <input type="date" formControlName="dataFinal" class="form-control" id="dataFinal" name="dataFinal" (change)="validaDataFinal()" />
      </div>
    </div>
  </fieldset>

  <fieldset class="border mb-4">
    <legend class="col-form-label">Dados Internos</legend>
    <div class="form-group row">
      <div class="col-5 p-2">
        <label>Tecnologias do Projeto *</label>
        <select multiple class="form-control" name="tecAssociadas" [(ngModel)]="tecnologiaToRemove" [ngModelOptions]="{standalone: true}">
          <option *ngFor="let i of tecnologiaAssociadas" value="{{i.id}}">{{i.nome}}</option>
        </select>
      </div>
      <div class="col-2 mt-4 text-center">
        <div class="mt-2">
          <button class="btn btn-success" (click)="adicionarTecnologia()">
            <<</button> </div> <div>
              <button class="btn btn-danger" (click)="removerTecnologia()">>></button>
        </div>
      </div>
      <div class="col-5 p-2">
        <label>Tecnologias Disponíveis</label>
        <select multiple class="form-control" name="tecDisponiveis" [(ngModel)]="tecnologiaToAdd" [ngModelOptions]="{standalone: true}">
          <option *ngFor="let i of tecnologiaDisponiveis" value="{{i.id}}">{{i.nome}}</option>
        </select>
      </div>
      <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="tecnologiaAssociadas.length==0">
        <i class="fa fa-times mr-2"></i>
        <small>Por favor, associar ao menos uma Tecnologia ao projeto</small>
      </div>
    </div>
    <div class="form-group row">
      <div class="col-md-6">
        <label for="label">EXT</label>
        <select formControlName="ext" class="form-control" id="ext" name="ext">
          <option *ngFor="let e of exts" value="{{e.id}}">{{e.nome}}</option>
        </select>
      </div>

      <div class="col-md-6">
        <label for="label">Tamanho *</label>
        <select formControlName="tamanho" class="form-control" id="tamanho" name="tamanho">
          <option value="P">P</option>
          <option value="M">M</option>
          <option value="G">G</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.tamanho.touched || dadosPrincipaisForm.controls.tamanho.dirty) && dadosPrincipaisForm.controls.tamanho.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Tamanho do Projeto</small>
        </div>
      </div>
    </div>

    <div class="form-group row">
      <div class="col-5 p-2">
        <label>Tipos de Demanda do Projeto *</label>
        <select multiple class="form-control" name="tipoDemAssociadas" [(ngModel)]="tipoDemandaToRemove"
          [ngModelOptions]="{standalone: true}">
          <option *ngFor="let i of tipoDemandaAssociadas" value="{{i.id}}">{{i.nome}}</option>
        </select>
      </div>
      <div class="col-2 mt-4 text-center">
        <div class="mt-2">
          <button class="btn btn-success" (click)="adicionarTipoDemanda()">
            <<</button> </div> <div>
              <button class="btn btn-danger" (click)="removerTipoDemanda()">>></button>
        </div>
      </div>
      <div class="col-5 p-2">
        <label>Tipos de Demanda Disponíveis</label>
        <select multiple class="form-control" name="tipoDemDisponiveis" [(ngModel)]="tipoDemandaToAdd" [ngModelOptions]="{standalone: true}">
          <option *ngFor="let i of tipoDemandaDisponiveis" value="{{i.id}}">{{i.nome}}</option>
        </select>
      </div>
      <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="tipoDemandaAssociadas.length==0">
        <i class="fa fa-times mr-2"></i>
        <small>Por favor, associar ao menos um Tipo de Demanda ao projeto</small>
      </div>
    </div>
  </fieldset>


  <fieldset class="border mb-4">
    <legend class="col-form-label">Dados do Cliente</legend>
    <div class="form-group row">
      <div class="col-md-3">
        <label for="label">Empresa *</label>
        <select formControlName="empresaId" class="form-control" id="empresaId" name="empresaId">
          <option *ngFor="let empresa of empresas" value="{{empresa.id}}">{{empresa.nome}}</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.empresaId.touched || dadosPrincipaisForm.controls.empresaId.dirty) && dadosPrincipaisForm.controls.empresaId.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe o Nome da Empresa</small>
        </div>
      </div>

      <div class="col-md-2">
        <label for="label">Sigla *</label>
        <select formControlName="siglaId" class="form-control" id="siglaid" name="siglaId">
          <option *ngFor="let sigla of sigla" value="{{sigla.id}}">{{sigla.descricao}}</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.siglaId.touched || dadosPrincipaisForm.controls.siglaId.dirty) && dadosPrincipaisForm.controls.siglaId.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Sigla</small>
        </div>
      </div>

      <div class="col-md-2">
        <label for="label">Diretoria *</label>
        <select formControlName="diretoriaId" class="form-control" id="diretoriaId" name="diretoriaid">
          <option *ngFor="let dir of diretoria" value="{{dir.id}}">{{dir.descricao}}</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.diretoriaId.touched || dadosPrincipaisForm.controls.diretoriaId.dirty) && dadosPrincipaisForm.controls.diretoriaId.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Diretoria</small>
        </div>
      </div>

      <div class="col-md-3">
        <label for="label">Superintendência *</label>
        <select formControlName="superintendenciaId" class="form-control" id="superintendenciaId" name="superintendenciaid">
          <option *ngFor="let superintendencia of superintendencia" value="{{superintendencia.id}}">{{superintendencia.descricao}}</option>
        </select>
        <div class="alert alert-danger m-0 mt-2 p-1 pl-2 pr-2 w-100" *ngIf="(dadosPrincipaisForm.controls.superintendenciaId.touched || dadosPrincipaisForm.controls.superintendenciaId.dirty) && dadosPrincipaisForm.controls.superintendenciaId.invalid">
          <i class="fa fa-times mr-2"></i>
          <small>Por favor, informe a Superintendência</small>
        </div>
      </div>
    </div>
  </fieldset>

  <fieldset class="border mb-3">
    <legend class="col-form-label">Esforço</legend>
    <div class="form-group row">
      <div class="col-md-3">
        <label>Serviço 1</label>
        <input type="number" formControlName="qtdHorasServico1" class="form-control" id="qtdhorasservico1" name="qtdhorasservico1"
          min="1" max="9999999999" (keydown)="setMaxValue('qtdHorasServico1')" />
      </div>
      <div class="col-md-3">
        <label>Serviço 2</label>
        <input type="number" formControlName="qtdHorasServico2" class="form-control" id="qtdhorasservico2" name="qtdhorasservico2"
          min="1" max="9999999999" (keydown)="setMaxValue('qtdHorasServico2')" />
      </div>
      <div class="col-md-3">
        <label>Serviço 3</label>
        <input type="number" formControlName="qtdHorasServico3" class="form-control" id="qtdhorasservico3" name="qtdhorasservico3"
          min="1" max="9999999999" (keydown)="setMaxValue('qtdHorasServico3')" />
      </div>
    </div>
  </fieldset>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Escopo do Projeto
      </mat-panel-title>
    </mat-expansion-panel-header>
    <div class="form-group ">
      <textarea formControlName="escopoProjeto" class="form-control" id="escopoprojeto" name="escopoprojeto" rows="5"
        maxlength="500"></textarea>
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Fora do Escopo do Projeto
      </mat-panel-title>
    </mat-expansion-panel-header>
    <textarea formControlName="foraEscopoProjeto" class="form-control" id="foraescopoprojeto" name="foraescopoprojeto"
      maxlength="500" rows="5"></textarea>
  </mat-expansion-panel>

  <mat-expansion-panel class="mb-3 border">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Premissas
      </mat-panel-title>
    </mat-expansion-panel-header>

    <textarea formControlName="premissas" class="form-control" id="premissas" name="premissas" rows="5" maxlength="500"></textarea>

  </mat-expansion-panel>

  <div class="row align-items-center mt-2 mb-4">
    <div class="col d-flex justify-content-end">
      <button type="button" class="btn everis mr-2" (click)="Adicionar()" [disabled]="!formEstaValido()">Salvar</button>
      <button type="button" class="btn cancelar" (click)="cancelar()">Cancelar</button>
    </div>
  </div>

</form>